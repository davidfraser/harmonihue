<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<h1><a href="http://www.frasergo.org/projects/harmonihue/index.html" title="Harmonic Hues, © David Fraser 2013">HarmoniHue</a></h1>
<h3>Some Musical Maths</h3>
<h4>The Twelve-Tone Scale</h4>
<p>The twelve-tone system was derived as a compromise between the natural harmonics generated on physical instruments, and the desire to be able to play in different keys without complicated tuning. The following chart demonstrates the different harmonics and the intervals that they generate when applied repeatedly but reduced to the same octave, and compares them to the even-tempered scale. The labels on the dots indicate the number of times the interval has been repeated from the base interval (and the fading is greater for a greater number of repetitions)</p>
<p><img src="draw_even_temper.png"/></p>
<p>This illustrates how the frequencies generated by repeating a perfect fifth match very closely to the even-tempered scale, and how it produces a good approximation for major thirds as well.</p>
<h4>The circle of fifths</h4>
<p>A <b>circle of fifths</b> may be produced where the twelve tones are arranged into a cycle where adjacent tones are separated by a perfect fifth (7 semi-tones). (This is the only fixed-interval cycle that covers the whole twelve-tone scale, since (1, 11) and (5, 7) are the only pairs of numbers below 12 that are relatively prime to 12).</p>
<p>The twelve tones can be displayed visually in a circle either in standard order, or in the circle of fifths:</p>
<table>
 <tr><th>Semitone Order</th><th>Fifths Order</th></tr>
 <tr><td><img src="draw_tone_circle_1.png"/></td><td><img src="draw_tone_circle_7.png"/></td></tr>
</table>
<h4>Harmonic Space</h4>
<p>Let's first try to establish the mathematical relationship between notes more carefully. Since we are looking to quantify differences between different notes, this can be represented by picturing the notes as arranged in a space, where the distance between the notes corresponds to how discordant those two notes sound when played together.</p>
<p>We'll then require a function <tt>hd</tt> that is a <i>metric</i> on the frequency space, which approximates the <i>harmonic difference</i> between two frequencies. The result should be low for frequencies that are close harmonies of each other, and high for frequencies that aren't. The following principles will apply:</p>
<table>
 <tr><th>Principle</th><th>Mathematical Formulation</th></tr>
 <tr><td>Notes are perfectly harmonious with themselves</td><td><tt>hd(a, a) = 0</tt></td></tr>
 <tr><td>Notes exactly an octave a part are equivalent</td><td><tt>hd(a, 2a) = 0</tt></td></tr>
 <tr><td>Harmonic difference is independent of direction (commutative)</td><td><tt>hd(a, b) = hd(b, a)</tt></td></tr>
 <tr><td>Harmonic difference is constant for any interval - therefore independent under transposition</td><td><tt>hd(a, b) = hd(ra, rb)</tt></td></tr>
</table>
<p>The circle of fifths is advantageous because a perfect fifth is the closest harmony other than an octave, being derived from dividing a pitch by 3 (the lowest natural number other than 2 - which produces octaves)</p>
<p>Basing the difference directly on the distance between two points on the circle of fifths is simple; the first table contains tones in the order of the circle of fifths, the second on their standard pitch-based order:</p>
<table style="border: 1px solid grey;">
 <tr><th style="text-align: left;">Tone</th><td style="width: 3em;"><tt>A</tt></td><td style="width: 3em;"><tt>E</tt></td><td style="width: 3em;"><tt>B</tt></td><td style="width: 3em;"><tt>F#</tt></td><td style="width: 3em;"><tt>C#</tt></td><td style="width: 3em;"><tt>Ab</tt></td><td style="width: 3em;"><tt>Eb</tt></td><td style="width: 3em;"><tt>Bb</tt></td><td style="width: 3em;"><tt>F</tt></td><td style="width: 3em;"><tt>C</tt></td><td style="width: 3em;"><tt>G</tt></td><td style="width: 3em;"><tt>D</tt></td></tr>
 <tr><th style="text-align: left;">Index</th><td><tt>0</tt></td><td><tt>7</tt></td><td><tt>2</tt></td><td><tt>9</tt></td><td><tt>4</tt></td><td><tt>11</tt></td><td><tt>6</tt></td><td><tt>1</tt></td><td><tt>8</tt></td><td><tt>3</tt></td><td><tt>10</tt></td><td><tt>5</tt></td></tr>
 <tr><th style="text-align: left;">Position</th><td><tt>0</tt></td><td><tt>1</tt></td><td><tt>2</tt></td><td><tt>3</tt></td><td><tt>4</tt></td><td><tt>5</tt></td><td><tt>6</tt></td><td><tt>7</tt></td><td><tt>8</tt></td><td><tt>9</tt></td><td><tt>10</tt></td><td><tt>11</tt></td></tr>
</table>
<table style="border: 1px solid grey;">
 <tr><th style="text-align: left;">Tone</th><td style="width: 3em;"><tt>A</tt></td><td style="width: 3em;"><tt>Bb</tt></td><td style="width: 3em;"><tt>B</tt></td><td style="width: 3em;"><tt>C</tt></td><td style="width: 3em;"><tt>C#</tt></td><td style="width: 3em;"><tt>D</tt></td><td style="width: 3em;"><tt>Eb</tt></td><td style="width: 3em;"><tt>E</tt></td><td style="width: 3em;"><tt>F</tt></td><td style="width: 3em;"><tt>F#</tt></td><td style="width: 3em;"><tt>G</tt></td><td style="width: 3em;"><tt>Ab</tt></td></tr>
 <tr><th style="text-align: left;">Index</th><td><tt>0</tt></td><td><tt>1</tt></td><td><tt>2</tt></td><td><tt>3</tt></td><td><tt>4</tt></td><td><tt>5</tt></td><td><tt>6</tt></td><td><tt>7</tt></td><td><tt>8</tt></td><td><tt>9</tt></td><td><tt>10</tt></td><td><tt>11</tt></td></tr>
 <tr><th style="text-align: left;">Position</th><td><tt>0</tt></td><td><tt>7</tt></td><td><tt>2</tt></td><td><tt>9</tt></td><td><tt>4</tt></td><td><tt>11</tt></td><td><tt>6</tt></td><td><tt>1</tt></td><td><tt>8</tt></td><td><tt>3</tt></td><td><tt>10</tt></td><td><tt>5</tt></td></tr>
</table>
<p>The equation <tt>hd(a, b) = p(a) - p(b) (mod 12)</tt> (where <tt>p</tt> is the position in the circle of fifths) represents this distance, which then trivially satisfies some of the above conditions for harmonic difference. However, we have not yet investigated the relative dischordancy of intervals, or explored the structure of this harmonic space.</p>
<h4>Geometry of intervals in the twelve-tone-space</h4>
<p>Because 12 is not a prime, intervals of 2, 3, 4 and 6 semitones form cycles: The intervals generated by repeated major thirds (4 semitones) comprise an "equilateral triangle" - each side must be the same length. Likewise the intervals generated by repeated minor thirds (3 semitones) comprise a "square" - each side must be the same length. Major seconds (2 semitones) generate two hexagons, and augmented fourths (6 semitones) generate 6 pairs of numbers.</p>
<p>The following table demonstrates these cycles on both the circle of fifths and the circle of semitones</p>
<table>
    <tr><th>Interval</th><th>Cycle</th><th>Circle of fifths</th><th>Circle of Semitones</th></tr>
    <tr>
        <th>1 / 11</th>
        <td>
        <table>
        <tr><td style="width: 3em; color: #1f77b4;">A</td><td style="width: 3em; color: #1f77b4;">Bb</td><td style="width: 3em; color: #1f77b4;">B</td><td style="width: 3em; color: #1f77b4;">C</td><td style="width: 3em; color: #1f77b4;">C#</td><td style="width: 3em; color: #1f77b4;">D</td><td style="width: 3em; color: #1f77b4;">Eb</td><td style="width: 3em; color: #1f77b4;">E</td><td style="width: 3em; color: #1f77b4;">F</td><td style="width: 3em; color: #1f77b4;">F#</td><td style="width: 3em; color: #1f77b4;">G</td><td style="width: 3em; color: #1f77b4;">Ab</td></tr></table>
        </td>
        <td>
          <img src="draw_tone_cycles_1_7.png"/>
        </td>
        <td>
          <img src="draw_tone_cycles_1_1.png"/>
        </td>
    </tr><tr>
        <th>2 / 10</th>
        <td>
        <table>
        <tr><td style="width: 3em; color: #1f77b4;">A</td><td style="width: 3em; color: #1f77b4;">B</td><td style="width: 3em; color: #1f77b4;">C#</td><td style="width: 3em; color: #1f77b4;">Eb</td><td style="width: 3em; color: #1f77b4;">F</td><td style="width: 3em; color: #1f77b4;">G</td></tr></table><table>
        <tr><td style="width: 3em; color: #ff7f0e;">Bb</td><td style="width: 3em; color: #ff7f0e;">C</td><td style="width: 3em; color: #ff7f0e;">D</td><td style="width: 3em; color: #ff7f0e;">E</td><td style="width: 3em; color: #ff7f0e;">F#</td><td style="width: 3em; color: #ff7f0e;">Ab</td></tr></table>
        </td>
        <td>
          <img src="draw_tone_cycles_2_7.png"/>
        </td>
        <td>
          <img src="draw_tone_cycles_2_1.png"/>
        </td>
    </tr><tr>
        <th>3 / 9</th>
        <td>
        <table>
        <tr><td style="width: 3em; color: #1f77b4;">A</td><td style="width: 3em; color: #1f77b4;">C</td><td style="width: 3em; color: #1f77b4;">Eb</td><td style="width: 3em; color: #1f77b4;">F#</td></tr></table><table>
        <tr><td style="width: 3em; color: #ff7f0e;">Bb</td><td style="width: 3em; color: #ff7f0e;">C#</td><td style="width: 3em; color: #ff7f0e;">E</td><td style="width: 3em; color: #ff7f0e;">G</td></tr></table><table>
        <tr><td style="width: 3em; color: #2ca02c;">B</td><td style="width: 3em; color: #2ca02c;">D</td><td style="width: 3em; color: #2ca02c;">F</td><td style="width: 3em; color: #2ca02c;">Ab</td></tr></table>
        </td>
        <td>
          <img src="draw_tone_cycles_3_7.png"/>
        </td>
        <td>
          <img src="draw_tone_cycles_3_1.png"/>
        </td>
    </tr><tr>
        <th>4 / 8</th>
        <td>
        <table>
        <tr><td style="width: 3em; color: #1f77b4;">A</td><td style="width: 3em; color: #1f77b4;">C#</td><td style="width: 3em; color: #1f77b4;">F</td></tr></table><table>
        <tr><td style="width: 3em; color: #ff7f0e;">Bb</td><td style="width: 3em; color: #ff7f0e;">D</td><td style="width: 3em; color: #ff7f0e;">F#</td></tr></table><table>
        <tr><td style="width: 3em; color: #2ca02c;">B</td><td style="width: 3em; color: #2ca02c;">Eb</td><td style="width: 3em; color: #2ca02c;">G</td></tr></table><table>
        <tr><td style="width: 3em; color: #d62728;">C</td><td style="width: 3em; color: #d62728;">E</td><td style="width: 3em; color: #d62728;">Ab</td></tr></table>
        </td>
        <td>
          <img src="draw_tone_cycles_4_7.png"/>
        </td>
        <td>
          <img src="draw_tone_cycles_4_1.png"/>
        </td>
    </tr><tr>
        <th>5 / 7</th>
        <td>
        <table>
        <tr><td style="width: 3em; color: #1f77b4;">A</td><td style="width: 3em; color: #1f77b4;">D</td><td style="width: 3em; color: #1f77b4;">G</td><td style="width: 3em; color: #1f77b4;">C</td><td style="width: 3em; color: #1f77b4;">F</td><td style="width: 3em; color: #1f77b4;">Bb</td><td style="width: 3em; color: #1f77b4;">Eb</td><td style="width: 3em; color: #1f77b4;">Ab</td><td style="width: 3em; color: #1f77b4;">C#</td><td style="width: 3em; color: #1f77b4;">F#</td><td style="width: 3em; color: #1f77b4;">B</td><td style="width: 3em; color: #1f77b4;">E</td></tr></table>
        </td>
        <td>
          <img src="draw_tone_cycles_5_7.png"/>
        </td>
        <td>
          <img src="draw_tone_cycles_5_1.png"/>
        </td>
    </tr><tr>
        <th>6</th>
        <td>
        <table>
        <tr><td style="width: 3em; color: #1f77b4;">A</td><td style="width: 3em; color: #1f77b4;">Eb</td></tr></table><table>
        <tr><td style="width: 3em; color: #ff7f0e;">Bb</td><td style="width: 3em; color: #ff7f0e;">E</td></tr></table><table>
        <tr><td style="width: 3em; color: #2ca02c;">B</td><td style="width: 3em; color: #2ca02c;">F</td></tr></table><table>
        <tr><td style="width: 3em; color: #d62728;">C</td><td style="width: 3em; color: #d62728;">F#</td></tr></table><table>
        <tr><td style="width: 3em; color: #9467bd;">C#</td><td style="width: 3em; color: #9467bd;">G</td></tr></table><table>
        <tr><td style="width: 3em; color: #8c564b;">D</td><td style="width: 3em; color: #8c564b;">Ab</td></tr></table>
        </td>
        <td>
          <img src="draw_tone_cycles_6_7.png"/>
        </td>
        <td>
          <img src="draw_tone_cycles_6_1.png"/>
        </td>
    </tr>
</table>
<h4>Relative Dischordancy</h4>
<p>We've already defined octaves as of no distance. The next purest interval is a perfect fifth (dividing frequency by 3), followed by a major third (dividing it by 5). Generally in western music the order of dischordancy is clear (starting with least dischordant):</p>
<table>
 <tr><th>Interval</th><th>Semitones</th><th>Inverse Interval</th><th>Semitones</th></tr>
 <tr><td>Unison</td><td>0</td><td>Octave</td><td>12</td></tr>
 <tr><td>Perfect Fifth</td><td>7</td><td>Perfect Fourth</td><td>5</td></tr>
 <tr><td>Major Third</td><td>4</td><td>Minor Sixth</td><td>8</td></tr>
 <tr><td>Minor Third</td><td>3</td><td>Major Sixth</td><td>9</td></tr>
 <tr><td>Whole Tone</td><td>2</td><td>Minor Seventh</td><td>10</td></tr>
 <tr><td>Semitone</td><td>1</td><td>Major Seventh</td><td>11</td></tr>
 <tr><td>Augmented Fourth</td><td>6</td><td>Diminished Fifth</td><td>6</td></tr>
</table>
<p>This assumes that the dischordancy of an interval is exactly the same as its inverse (which we've assumed above, and which makes a metric space easier, although it may not be exactly true in practice).</p>
<p>We can express this as:<br/>
<tt>0 = d(0) &lt; d(5) &lt; d(4) &lt; d(3) &lt; d(2) &lt; d(1) &lt; d(6)</tt></p>
<p>However, simply using the circle of fifths generates the following order instead:<br/>
<tt>0 = d(0) &lt; d(5) &lt; d(2) &lt; d(3) &lt; d(4) &lt; d(1) &lt; d(6)</tt></p>
<p>This is so using any measure that simply orders based on the circle of fifths, since whole tones end up before major thirds in that order. The two most obvious ones are radial distance around the circle and distance of a straight line across the circle in two dimensions.</p>
<h4>A Tuneful Torus</h4>
<p>In order to modify the order whilst still retaining the same basic structure, let's consider an extension of the circle to a <i>torus</i> (or doughnut shape in 3 dimensions). The aim is to increase the distance for the whole tone (the second repeat of the perfect fifth), whilst reducing it for the major third and minor third (the third and fourth repeats). It's important that the whole structure needs to preserve the symmetries we discovered above.</p>
<p>Define the distance between two points on the surface of the torus as the sum of the (scaled) differences of their <i>toroidal</i> angle (from the center - γ) and their <i>poloidal</i> angle (around the small circle of the ring - θ). Then we want to maximize θ for <tt>d(2)</tt> whilst minimizing it for <tt>d(4)</tt> and <tt>d(3)</tt>. This can be accomplished by arranging the points in a spiral around the "ring" of the doughnut so that a whole tone results in moving to the opposite side, but another whole tone comes back to the same θ-position - which implies that each semitone will move 90° around the ring.</p>
<p><img src="draw_torus_10.0_5.0_10_10.png"/></p>
<table>
    <tr><th>Interval</th><th>Toroidal Angle (γ)</th><th>Poloidal Angle (θ)</th><th>Distance (2γ + θ)</th></tr>
    <tr>
       <td>0</td>
       <td>0*π/6</td>
       <td>0*π/2</td>
       <td>0*π/6</td>
    </tr><tr>
       <td>7</td>
       <td>1*π/6</td>
       <td>1*π/2</td>
       <td>5*π/6</td>
    </tr><tr>
       <td>4</td>
       <td>4*π/6</td>
       <td>0*π/2</td>
       <td>8*π/6</td>
    </tr><tr>
       <td>3</td>
       <td>3*π/6</td>
       <td>1*π/2</td>
       <td>9*π/6</td>
    </tr><tr>
       <td>2</td>
       <td>2*π/6</td>
       <td>2*π/2</td>
       <td>10*π/6</td>
    </tr><tr>
       <td>1</td>
       <td>5*π/6</td>
       <td>1*π/2</td>
       <td>13*π/6</td>
    </tr><tr>
       <td>6</td>
       <td>6*π/6</td>
       <td>2*π/2</td>
       <td>18*π/6</td>
    </tr>
</table>
<p>Please note that the two-dimensional projections included here are not ideal - by running the interactive examples you can rotate the torus to get a clearer idea of each figure.</p>
<p>The geometrical patterns we saw earlier for tone cycles can also be <a href="torus-tone-geometry.html">visualized on this torus projection</a>. Scales and chords also show <a href="scale-diagrams.html">interesting patterns on the circle of fifths</a> in either space.</p>
<p><tt>© David Fraser 2013</tt></p>
